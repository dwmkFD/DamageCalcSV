
    <main>
            <MudGrid Spacing="@spacing" Justify="Justify.Center">
                <MudItem xs="12"><MudText>@Title</MudText></MudItem>
                    <MudItem xs="6">
                        <MudAutocomplete T="string" Label="ポケモン" @bind-Value="PokemonName" SearchFunc="@search_pokemon" Margin="Margin.Dense" />
                    </MudItem>
                    <MudItem xs="4">
                    <MudSelect T="string" Label="性格" Variant="Variant.Outlined" AnchorOrigin="Origin.BottomCenter" Margin="Margin.Dense">
                        @foreach( var n in nature )
                        {
                            <MudSelectItem T="string" Value="@n" />
                        }
                        </MudSelect>
                    </MudItem>

                    <MudItem xs="2">
                        <MudNumericField @bind-Value="Level" Label="レベル" Variant="Variant.Outlined" Min="1" Max="100" Margin="Margin.Dense" />
                    </MudItem>

                    <MudItem xs="2">
                        <MudText>実数値：</MudText>
                    </MudItem>
                    <MudItem xs="10">
                    <MudItem xs="12">
                        <MudGrid Spacing="0">
                            <MudItem xs="2">
                                <MudNumericField @bind-Value="status[0]" Label="ＨＰ" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            </MudItem>
                            <MudItem sm="2">
                                <MudNumericField @bind-Value="status[1]" Label="攻撃" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            </MudItem>
                            <MudItem xs="2">
                                <MudNumericField @bind-Value="status[2]" Label="防御" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            </MudItem>
                            <MudItem xs="2">
                                <MudNumericField @bind-Value="status[3]" Label="特攻" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            </MudItem>
                            <MudItem xs="2">
                                <MudNumericField @bind-Value="status[4]" Label="特防" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            </MudItem>
                            <MudItem xs="2">
                                <MudNumericField @bind-Value="status[5]" Label="素早さ" Variant="Variant.Outlined" Margin="Margin.Dense" />
                            </MudItem>
                        </MudGrid>
                    </MudItem>
                </MudItem>

                <MudItem xs="2">
                    <MudText>個体値：</MudText>
                </MudItem>
                <MudItem xs="10">
                    <MudItem xs="12">
                        <MudGrid Spacing="0">
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[6]" Variant="Variant.Outlined" Min="0" Max="31" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem sm="2">
                            <MudNumericField @bind-Value="status[7]" Variant="Variant.Outlined" Min="0" Max="31" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                            <MudNumericField @bind-Value="status[8]" Variant="Variant.Outlined" Min="0" Max="31" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[9]" Variant="Variant.Outlined" Min="0" Max="31" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[10]" Variant="Variant.Outlined" Min="0" Max="31" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[11]" Variant="Variant.Outlined" Min="0" Max="31" Margin="Margin.Dense" />
                        </MudItem>
                    </MudGrid>
                </MudItem>
                </MudItem>


                <MudItem xs="2">
                    <MudText>努力値：</MudText>
                </MudItem>
                <MudItem xs="10">
                    <MudItem xs="12">
                        <MudGrid Spacing="0">
                        <MudItem xs="2">
                            <MudNumericField @bind-Value="status[12]" Variant="Variant.Outlined" Min="0" Max="252" Step="4" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem sm="2">
                        <MudNumericField @bind-Value="status[13]" Variant="Variant.Outlined" Min="0" Max="252" Step="4" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[14]" Variant="Variant.Outlined" Min="0" Max="252" Step="4" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[15]" Variant="Variant.Outlined" Min="0" Max="252" Step="4" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[16]" Variant="Variant.Outlined" Min="0" Max="252" Step="4" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="status[17]" Variant="Variant.Outlined" Min="0" Max="252" Step="4" Margin="Margin.Dense" />
                        </MudItem>
                    </MudGrid>
                </MudItem>
                </MudItem>
                <MudItem xs="2">
                </MudItem>
                <MudItem xs="10">
                    <MudItem xs="12">
                        <MudGrid Spacing="0">
                        <MudItem xs="2">
                            <MudButton OnClick="@(s => _efvalToggleText(0))" Variant="Variant.Filled" FullWidth="true">@_efvalToggleValue[0]</MudButton>
                        </MudItem>
                        <MudItem sm="2">
                                <MudButton OnClick="@(s => _efvalToggleText(1))" Variant="Variant.Filled" FullWidth="true">@_efvalToggleValue[1]</MudButton>
                        </MudItem>
                        <MudItem xs="2">
                                <MudButton OnClick="@(s => _efvalToggleText(2))" Variant="Variant.Filled" FullWidth="true">@_efvalToggleValue[2]</MudButton>
                        </MudItem>
                        <MudItem xs="2">
                                <MudButton OnClick="@(s => _efvalToggleText(3))" Variant="Variant.Filled" FullWidth="true">@_efvalToggleValue[3]</MudButton>
                        </MudItem>
                        <MudItem xs="2">
                                <MudButton OnClick="@(s => _efvalToggleText(4))" Variant="Variant.Filled" FullWidth="true">@_efvalToggleValue[4]</MudButton>
                        </MudItem>
                        <MudItem xs="2">
                                <MudButton OnClick="@(s => _efvalToggleText(5))" Variant="Variant.Filled" FullWidth="true">@_efvalToggleValue[5]</MudButton>
                        </MudItem>
                        </MudGrid>
                    </MudItem>
                </MudItem>

                <MudItem xs="2">
                    <MudText>ランク：</MudText>
                </MudItem>
                <MudItem xs="10">
                    <MudItem xs="12">
                        <MudGrid Spacing="0">
                        <MudItem xs="2" />
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="rank[0]" Variant="Variant.Outlined" Min="-6" Max="6" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem sm="2">
                        <MudNumericField @bind-Value="rank[1]" Variant="Variant.Outlined" Min="-6" Max="6" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="rank[2]" Variant="Variant.Outlined" Min="-6" Max="6" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="rank[3]" Variant="Variant.Outlined" Min="-6" Max="6" Margin="Margin.Dense" />
                        </MudItem>
                        <MudItem xs="2">
                        <MudNumericField @bind-Value="rank[4]" Variant="Variant.Outlined" Min="-6" Max="6" Margin="Margin.Dense" />
                            </MudItem>
                        </MudGrid>
                </MudItem>
                </MudItem>

                <MudItem xs="4">
            <MudSelect T="string" Label="特性" Variant="Variant.Outlined" AnchorOrigin="Origin.BottomCenter" Margin="Margin.Dense">
                        <MudSelectItem Value="@("未発動")" />
                    </MudSelect>
                </MudItem>
                <MudItem xs="5">
            <MudSelect T="string" Label="道具" Variant="Variant.Outlined" AnchorOrigin="Origin.BottomCenter" Margin="Margin.Dense">
                @foreach( var i in PokemonItem )
                {
                    <MudSelectItem T="string" Value="@i" />
                }
                    </MudSelect>
                </MudItem>
                <MudItem xs="3">
            <MudSelect T="string" Label="テラスタイプ" Variant="Variant.Outlined" AnchorOrigin="Origin.BottomCenter" Margin="Margin.Dense">
                @foreach( var t in teratype )
                {
                    <MudSelectItem T="string" Value="@t" />
                }
                    </MudSelect>
                </MudItem>

                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[0]" Size="Size.Small" Label="リフレクター"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[1]" Size="Size.Small" Label="ひかりのかべ"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[2]" Size="Size.Small" Label="てだすけ"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[3]" Size="Size.Small" Label="きあいだめ"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[4]" Size="Size.Small" Label="じゅうでん"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[5]" Size="Size.Small" Label="そうでん"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[6]" Size="Size.Small" Label="はがねのせいしん"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[7]" Size="Size.Small" Label="フラワーギフト"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[8]" Size="Size.Small" Label="ハロウィン"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[9]" Size="Size.Small" Label="もりののろい"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[10]" Size="Size.Small" Label="みずびたし"></MudCheckBox>
                    </MudForm>
                </MudItem>
                <MudItem xs="4">
                    <MudForm>
                        <MudCheckBox @bind-Checked="@options[11]" Size="Size.Small" Label="フレンドガード"></MudCheckBox>
                    </MudForm>
                </MudItem>

    </MudGrid>
    </main>

@code {
    public int spacing { get; set; } = 1;

    private string PokemonName;
    private List<string> PokemonNameList = new List<string>();

    private string trans_katakana( string str )
    {
        return (str);
    }

    private async Task<IEnumerable<string>> search_pokemon( string str )
    {
        string s = trans_katakana(str);
        if (string.IsNullOrEmpty(s))
            return (PokemonNameList);
        return (PokemonNameList.Where(x => x.Contains(s, StringComparison.InvariantCultureIgnoreCase)));
    }

    public int Level { get; set; } = 50;

    private List<string> PokemonAbility = new List<string>();

    private string[] nature = {
        "がんばりや",
        "さみしがり A+B-", "いじっぱり A+C-", "やんちゃ A+D-", "ゆうかん A+S-",
        "ずぶとい B+A-", "わんぱく B+C-", "のうてんき B+D-", "のんき B+S-",
        "ひかえめ C+A-", "おっとり C+B-", "うっかりや C+D-", "れいせい C+S-",
        "おだやか D+A-", "おとなしい D+B-", "しんちょう D+C-", "なまいき D+S-",
        "おくびょう S+A-", "せっかち S+B-", "ようき S+C-", "むじゃき S+D-",
    };

    private string[] PokemonItem = {
        "もちものなし", "(攻撃系)", "タイプ強化", "ノーマルジュエル",
        "いのちのたま", "こころのしずく", "こだわりハチマキ", "こだわりメガネ",
        "こんごうだま", "しらたま", "しんかいのキバ", "するどいツメ", "たつじんのおび",
        "ちからのハチマキ", "でんきだま", "ながねぎ", "はっきんだま", "ピントレンズ",
        "ふといホネ", "メトロノーム(1回目)", "メトロノーム(2回目)", "メトロノーム(3回目)",
        "メトロノーム(4回目)", "メトロノーム(5回目)", "メトロノーム(6回目以降)","ものしりメガネ",
        "ラッキーパンチ", "(防御系)", "半減木の実", "くろいてっきゅう", "しんかいのウロコ",
        "しんかのきせき", "とつげきチョッキ", "メタルパウダー",
    };

    private string[] teratype = {
        "ノーマル", "ほのお", "みず", "でんき", "くさ",
        "こおり", "かくとう", "どく", "じめん", "ひこう",
        "エスパー", "むし", "いわ", "ゴースト",
        "ドラゴン", "あく", "はがね", "フェアリー",
    };

    private DamageCalcSV.Shared.Models.PokemonDataManager PokemonManager = new DamageCalcSV.Shared.Models.PokemonDataManager();

    private int[] status = new int[18];
    private int[] rank = new int[5];

    private int[] _efvalToggleValue = new int[6];
    void _efvalToggleText( int idx )
    {
        if (_efvalToggleValue[idx] == 252)
        {
            _efvalToggleValue[idx] = 0;
            status[12 + idx] = 252;
        }
        else
        {
            _efvalToggleValue[idx] = 252;
            status[12 + idx] = 0;
        }
    }

    private bool[] options = new bool[30];

    [Parameter] public string Title { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();

        PokemonManager.InitializePokemonData();
        PokemonNameList = PokemonManager.AllPokemonName();

        status[6] = status[7] = status[8] = status[9] = status[10] = status[11] = 31;
        _efvalToggleValue[0] = _efvalToggleValue[1] = _efvalToggleValue[2] = _efvalToggleValue[3] = _efvalToggleValue[4] = _efvalToggleValue[5] = 252;
    }
}
